basePath: /
definitions:
  greenride_internal_protocol.CancelPaymentRequest:
    properties:
      order_id:
        type: string
      reason:
        type: string
      user_id:
        type: string
    required:
    - order_id
    type: object
  greenride_internal_protocol.ChannelResult:
    properties:
      callback_data:
        description: 回调数据
        type: string
      channel_code:
        description: 渠道代码
        type: string
      channel_payment_id:
        description: 渠道订单ID
        type: string
      channel_status:
        description: 渠道状态
        type: string
      payment_id:
        description: 支付订单ID
        type: string
      redirect_url:
        description: 重定向URL
        type: string
      res_code:
        description: 响应码
        type: string
      res_msg:
        description: 响应消息
        type: string
      status:
        description: 支付状态
        type: string
      type:
        description: 交易类型
        type: string
    type: object
  greenride_internal_protocol.Checkout:
    properties:
      expired_at:
        type: integer
      order_id:
        type: string
      order_status:
        type: string
      payment_id:
        type: string
      payment_status:
        type: string
      user_id:
        type: string
    type: object
  greenride_internal_protocol.CheckoutStatusRequest:
    properties:
      checkout_id:
        description: checkout ID
        type: string
      user_id:
        description: 用户ID，用于验证权限
        type: string
    required:
    - checkout_id
    - user_id
    type: object
  greenride_internal_protocol.CreateOrderRatingRequest:
    properties:
      comment:
        description: 评价内容
        type: string
      is_anonymous:
        description: 是否匿名评价
        type: boolean
      order_id:
        type: string
      rating:
        description: 评分 1-5
        maximum: 5
        minimum: 1
        type: number
      tags:
        description: 评价标签(JSON格式)
        items:
          type: string
        type: array
      user_id:
        description: 评价者ID
        type: string
    required:
    - order_id
    - rating
    type: object
  greenride_internal_protocol.CreateOrderRequest:
    properties:
      notes:
        description: 扩展信息
        type: string
      price_id:
        description: 价格信息
        type: string
      user_id:
        description: 用户ID
        type: string
    required:
    - price_id
    type: object
  greenride_internal_protocol.EstimateRequest:
    properties:
      app_version:
        type: string
      base_price:
        description: 基础价格（内部计算用）
        type: number
      currency:
        description: 价格相关
        type: string
      dropoff_address:
        type: string
      dropoff_landmark:
        type: string
      dropoff_latitude:
        type: number
      dropoff_longitude:
        type: number
      estimated_distance:
        type: number
      estimated_duration:
        type: integer
      order_type:
        description: 订单类型，默认为网约车
        type: string
      passenger_count:
        description: 行程信息
        type: integer
      payment_method:
        type: string
      pickup_address:
        type: string
      pickup_landmark:
        type: string
      pickup_latitude:
        type: number
      pickup_longitude:
        type: number
      platform:
        description: 客户端信息
        type: string
      promo_codes:
        items:
          type: string
        type: array
      request_ip:
        type: string
      requested_at:
        description: 请求时间(时间戳毫秒)，0表示当前时间
        type: integer
      scheduled_at:
        description: 上下文信息
        type: integer
      service_area:
        type: string
      session_id:
        type: string
      snapshot_duration:
        description: 设置选项
        type: integer
      user_agent:
        type: string
      user_category:
        description: 用户类别
        type: string
      user_id:
        description: 基础信息
        type: string
      vehicle_category:
        description: sedan, suv, mpv, van, hatchback
        type: string
      vehicle_level:
        description: economy, comfort, premium, luxury
        type: string
    required:
    - dropoff_latitude
    - dropoff_longitude
    - pickup_latitude
    - pickup_longitude
    type: object
  greenride_internal_protocol.GetNearbyOrdersRequest:
    properties:
      latitude:
        type: number
      limit:
        description: 数量限制
        type: integer
      longitude:
        type: number
      order_type:
        description: 订单类型过滤
        type: string
      radius:
        description: 半径（公里）
        type: number
    type: object
  greenride_internal_protocol.GetVehiclesRequest:
    properties:
      limit:
        type: integer
      page:
        type: integer
    type: object
  greenride_internal_protocol.MapData:
    additionalProperties: {}
    type: object
  greenride_internal_protocol.Order:
    properties:
      accepted_at:
        type: integer
      auto_dispatch_enabled:
        type: boolean
      cancel_reason:
        type: string
      cancellation_fee:
        type: number
      cancelled_at:
        type: integer
      cancelled_by:
        description: 取消信息
        type: string
      channel_payment_id:
        type: string
      completed_at:
        type: integer
      created_at:
        type: integer
      currency:
        type: string
      current_round:
        type: integer
      details:
        allOf:
        - $ref: '#/definitions/greenride_internal_protocol.OrderDetail'
        description: 订单详情（兼容所有订单类型）
      discount_amount:
        description: 总优惠金额
        type: number
      discounted_amount:
        description: 优惠后总金额
        type: number
      dispatch_started_at:
        type: integer
      dispatch_status:
        description: 派单相关信息
        type: string
      dispatch_strategy:
        type: string
      driver:
        $ref: '#/definitions/greenride_internal_protocol.User'
      driver_ratings:
        items:
          $ref: '#/definitions/greenride_internal_protocol.Rating'
        type: array
      ended_at:
        type: integer
      last_dispatched_at:
        type: integer
      max_rounds:
        type: integer
      metadata:
        additionalProperties: {}
        type: object
      next_strategy:
        type: string
      notes:
        description: 其他信息
        type: string
      order_id:
        description: 订单基础信息
        type: string
      order_type:
        type: string
      original_amount:
        description: 金额信息
        type: number
      passenger:
        $ref: '#/definitions/greenride_internal_protocol.User'
      passenger_ratings:
        items:
          $ref: '#/definitions/greenride_internal_protocol.Rating'
        type: array
      payment_amount:
        description: 最终付款金额
        type: number
      payment_id:
        type: string
      payment_method:
        description: 支付信息
        type: string
      payment_redirect_url:
        description: 支付重定向URL
        type: string
      payment_result:
        description: 支付结果详情
        type: string
      payment_status:
        type: string
      platform_fee:
        type: number
      promo_codes:
        items:
          type: string
        type: array
      promo_discount:
        type: number
      provider_id:
        type: string
      schedule_type:
        description: 时间信息
        type: string
      scheduled_at:
        type: integer
      started_at:
        type: integer
      status:
        type: string
      user_id:
        type: string
      user_promo_discount:
        description: 用户优惠券折扣金额
        type: number
      user_promotion_ids:
        description: 使用的用户优惠券ID列表
        items:
          type: string
        type: array
      vehicle:
        $ref: '#/definitions/greenride_internal_protocol.Vehicle'
      version:
        type: integer
    type: object
  greenride_internal_protocol.OrderAcceptRequest:
    properties:
      order_id:
        description: 订单ID
        type: string
      user_id:
        description: 用户ID（司机ID）
        type: string
    required:
    - order_id
    - user_id
    type: object
  greenride_internal_protocol.OrderActionRequest:
    properties:
      action_type:
        description: 动作类型
        type: string
      dispatch_id:
        description: 派单ID
        type: string
      latitude:
        description: 到达纬度
        type: number
      longitude:
        description: 到达经度
        type: number
      order_id:
        description: 订单ID
        type: string
      reject_reason:
        description: 拒绝原因（枚举值或自定义文本）
        type: string
      user_id:
        description: 用户ID
        type: string
    required:
    - latitude
    - longitude
    type: object
  greenride_internal_protocol.OrderCancelAPIRequest:
    properties:
      order_id:
        description: 订单ID
        type: string
      reason:
        description: 取消原因
        type: string
    required:
    - order_id
    type: object
  greenride_internal_protocol.OrderDetail:
    properties:
      actual_distance:
        type: number
      actual_duration:
        type: integer
      courier_id:
        type: string
      courier_name:
        type: string
      courier_phone:
        type: string
      courier_rating:
        type: number
      delivery_address:
        type: string
      delivery_latitude:
        type: number
      delivery_longitude:
        type: number
      driver_id:
        description: 司机信息
        type: string
      driver_name:
        type: string
      driver_phone:
        type: string
      driver_rating:
        type: number
      dropoff_address:
        type: string
      dropoff_landmark:
        type: string
      dropoff_latitude:
        type: number
      dropoff_longitude:
        type: number
      estimated_distance:
        type: number
      estimated_duration:
        type: integer
      license_plate:
        type: string
      order_id:
        description: 通用字段
        type: string
      order_type:
        type: string
      passenger_count:
        type: integer
      passenger_id:
        description: 网约车详情字段（当order_type=ride时使用）
        type: string
      passenger_name:
        type: string
      passenger_phone:
        type: string
      pickup_address:
        type: string
      pickup_landmark:
        type: string
      pickup_latitude:
        type: number
      pickup_longitude:
        type: number
      restaurant_address:
        type: string
      restaurant_id:
        description: 外卖详情字段（当order_type=delivery时使用，预留）
        type: string
      restaurant_name:
        type: string
      restaurant_phone:
        type: string
      ride_type:
        type: string
      shipping_address:
        type: string
      store_address:
        type: string
      store_id:
        description: 购物详情字段（当order_type=shopping时使用，预留）
        type: string
      store_name:
        type: string
      tracking_number:
        type: string
      vehicle_category:
        type: string
      vehicle_color:
        type: string
      vehicle_id:
        description: 车辆信息
        type: string
      vehicle_level:
        type: string
      vehicle_model:
        type: string
      vehicle_photo:
        type: string
    type: object
  greenride_internal_protocol.OrderIDRequest:
    properties:
      order_id:
        description: 订单ID
        type: string
      user_id:
        description: 用户ID
        type: string
    required:
    - order_id
    type: object
  greenride_internal_protocol.OrderPaymentRequest:
    properties:
      account_name:
        type: string
      account_no:
        type: string
      email:
        type: string
      order_id:
        type: string
      payment_method:
        description: 内部设置
        type: string
      phone:
        type: string
      user_id:
        description: 内部设置
        type: string
    required:
    - order_id
    type: object
  greenride_internal_protocol.OrderPrice:
    properties:
      base_fare:
        description: 起步价
        type: number
      breakdowns:
        description: 价格明细分解
        items:
          $ref: '#/definitions/greenride_internal_protocol.PriceRuleResult'
        type: array
      calculation_time_ms:
        description: 计算元信息（扁平化）
        type: integer
      currency:
        description: 基础价格信息
        type: string
      discount_amount:
        description: 总折扣金额
        type: number
      discounted_fare:
        description: 优惠后折扣费用 (应用所有优惠后的价格)
        type: number
      distance:
        description: 距离（公里）
        type: number
      distance_fare:
        description: 里程费
        type: number
      duration:
        description: 预计用时（分钟）
        type: integer
      engine_version:
        description: 引擎版本
        type: string
      expires_at:
        description: 过期时间戳
        type: integer
      is_locked:
        description: 是否已锁定
        type: boolean
      order_type:
        description: 订单类型
        type: string
      original_fare:
        description: 优惠前原始费用 (所有费用项的总和)
        type: number
      price_id:
        description: 价格锁定信息（扁平化）
        type: string
      promo_discount:
        description: 优惠码折扣金额
        type: number
      rules_applied:
        description: 应用的规则数量
        type: integer
      rules_evaluated:
        description: 评估的规则数量
        type: integer
      service_fee:
        description: 服务费
        type: number
      surge_fare:
        description: 高峰期费用
        type: number
      time_fare:
        description: 时长费
        type: number
      user_promo_discount:
        description: 用户优惠券折扣金额
        type: number
      vehicle_category:
        description: 车辆类别
        type: string
      vehicle_level:
        description: 车辆级别
        type: string
    type: object
  greenride_internal_protocol.PageResult:
    properties:
      attach:
        additionalProperties: {}
        description: 附加数据
        type: object
      count:
        description: 总记录数
        type: integer
      current:
        description: 当前页码
        type: integer
      records:
        description: 记录列表
      result_type:
        description: 数据类型
        type: string
      size:
        description: 每页记录数
        type: integer
      total:
        description: 总页数
        type: integer
    type: object
  greenride_internal_protocol.PaymentMethodsRequest:
    properties:
      order_id:
        type: string
    required:
    - order_id
    type: object
  greenride_internal_protocol.PriceRuleResult:
    properties:
      amount:
        description: 计算结果字段
        type: number
      applied:
        description: 是否应用
        type: boolean
      category:
        type: string
      ccy:
        description: 货币
        type: string
      description:
        type: string
      display_name:
        type: string
      reason:
        description: 原因
        type: string
      rule_id:
        description: 基本规则信息
        type: string
      rule_name:
        type: string
    type: object
  greenride_internal_protocol.Rating:
    properties:
      comment:
        type: string
      created_at:
        type: integer
      id:
        type: integer
      is_anonymous:
        type: boolean
      order_id:
        type: string
      ratee_id:
        type: string
      ratee_type:
        description: user, provider
        type: string
      rater_id:
        type: string
      rater_type:
        description: user, provider
        type: string
      rating:
        description: 评分 1-5
        type: number
      replied_at:
        type: integer
      reply:
        type: string
      tags:
        items:
          type: string
        type: array
      updated_at:
        type: integer
    type: object
  greenride_internal_protocol.RatingIDRequest:
    properties:
      rating_id:
        description: 评价ID
        type: integer
      user_id:
        description: 用户ID
        type: string
    required:
    - rating_id
    - user_id
    type: object
  greenride_internal_protocol.ReplyToRatingRequest:
    properties:
      rating_id:
        description: 评价ID
        type: string
      reply:
        description: 回复内容
        type: string
      user_id:
        description: 评价者ID
        type: string
    required:
    - rating_id
    - reply
    type: object
  greenride_internal_protocol.Result:
    properties:
      code:
        type: string
      data: {}
      msg:
        type: string
    type: object
  greenride_internal_protocol.UpdateLocationRequest:
    properties:
      latitude:
        maximum: 90
        minimum: -90
        type: number
      longitude:
        maximum: 180
        minimum: -180
        type: number
      updated_at:
        description: 时间戳，毫秒
        type: integer
      user_id:
        description: 内部设置
        type: string
    required:
    - latitude
    - longitude
    type: object
  greenride_internal_protocol.UpdateOrderRatingRequest:
    properties:
      comment:
        description: 评价内容
        type: string
      rating:
        description: 评分 1-5
        maximum: 5
        minimum: 1
        type: number
      rating_id:
        description: 评价ID
        type: integer
      user_id:
        description: 评价者ID
        type: string
    required:
    - rating
    - rating_id
    type: object
  greenride_internal_protocol.User:
    properties:
      address:
        description: 联系信息
        type: string
      avatar:
        type: string
      birthday:
        type: integer
      city:
        type: string
      country:
        type: string
      country_code:
        type: string
      created_at:
        description: 时间戳
        type: integer
      deleted_at:
        description: 删除时间戳
        type: integer
      display_name:
        type: string
      email:
        type: string
      email_verified_at:
        type: integer
      first_name:
        type: string
      full_name:
        type: string
      gender:
        type: string
      invite_code:
        description: 推荐系统
        type: string
      invite_count:
        type: integer
      is_active:
        type: boolean
      is_email_verified:
        type: boolean
      is_phone_verified:
        type: boolean
      language:
        type: string
      last_login_at:
        type: integer
      last_name:
        type: string
      latitude:
        description: 位置信息
        type: number
      license_expiry:
        type: integer
      license_number:
        description: 司机相关信息
        type: string
      location_updated_at:
        type: integer
      longitude:
        type: number
      online_status:
        type: string
      phone:
        type: string
      phone_verified_at:
        type: integer
      postal_code:
        type: string
      sandbox:
        description: 沙盒信息
        type: integer
      score:
        type: number
      state:
        type: string
      status:
        description: 状态信息
        type: string
      timezone:
        type: string
      total_rides:
        type: integer
      updated_at:
        type: integer
      user_id:
        type: string
      user_type:
        type: string
      username:
        type: string
      vehicle:
        $ref: '#/definitions/greenride_internal_protocol.Vehicle'
    type: object
  greenride_internal_protocol.UserOnlineRequest:
    properties:
      latitude:
        description: 到达纬度
        type: number
      longitude:
        description: 到达经度
        type: number
      user_id:
        type: string
      vehicle_id:
        type: string
    required:
    - latitude
    - longitude
    - vehicle_id
    type: object
  greenride_internal_protocol.UserPromotionsRequest:
    properties:
      end_date:
        description: 结束日期过滤 (时间戳毫秒)
        type: integer
      limit:
        type: integer
      page:
        type: integer
      start_date:
        description: 开始日期过滤 (时间戳毫秒)
        type: integer
      status:
        description: 优惠券状态过滤
        type: string
      user_id:
        type: string
      user_type:
        description: 用户类型，自动识别
        type: string
    type: object
  greenride_internal_protocol.UserRidesRequest:
    properties:
      end_date:
        description: 结束日期过滤 (时间戳毫秒)
        type: integer
      limit:
        description: 每页数量，默认10
        type: integer
      order_type:
        description: 订单类型过滤
        type: string
      page:
        description: 页码，默认1
        type: integer
      start_date:
        description: 开始日期过滤 (时间戳毫秒)
        type: integer
      status:
        description: 订单状态过滤
        type: string
      user_id:
        description: 用户ID
        type: string
      user_type:
        description: 用户类型：user(乘客), driver(司机)，空则自动识别
        type: string
    type: object
  greenride_internal_protocol.Vehicle:
    properties:
      brand:
        type: string
      category:
        description: sedan, suv, mpv, van, hatchback
        type: string
      color:
        type: string
      created_at:
        description: 时间戳
        type: integer
      current_latitude:
        description: 位置信息
        type: number
      current_longitude:
        type: number
      documents:
        items:
          type: string
        type: array
      documents_verified:
        description: 验证状态
        type: boolean
      driver:
        $ref: '#/definitions/greenride_internal_protocol.User'
      driver_id:
        type: string
      engine_size:
        type: string
      fuel_type:
        description: petrol, diesel, electric, hybrid
        type: string
      has_air_conditioner:
        description: 车辆特性
        type: boolean
      has_bluetooth:
        type: boolean
      has_charger:
        type: boolean
      has_gps:
        type: boolean
      has_wifi:
        type: boolean
      inspection_date:
        type: string
      inspection_expiry:
        type: string
      inspection_passed:
        type: boolean
      insurance_company:
        type: string
      insurance_expiry:
        type: string
      insurance_policy_number:
        type: string
      last_service_date:
        description: 维护信息
        type: string
      last_used_at:
        description: 使用信息
        type: integer
      level:
        description: economy, comfort, premium, luxury
        type: string
      location_updated_at:
        type: integer
      model:
        type: string
      next_service_due:
        type: string
      notes:
        type: string
      photos:
        description: 文档和图片
        items:
          type: string
        type: array
      plate_number:
        type: string
      rating:
        description: 评价和统计
        type: number
      registration_expiry:
        type: string
      registration_number:
        description: 注册和保险信息
        type: string
      seat_capacity:
        type: integer
      service_mileage:
        type: integer
      status:
        description: 状态信息
        type: string
      total_distance:
        type: number
      total_mileage:
        type: integer
      total_rides:
        type: integer
      transmission:
        description: manual, automatic
        type: string
      type_id:
        description: 车辆类型和配置
        type: string
      updated_at:
        type: integer
      vehicle_id:
        description: 基础信息
        type: string
      verified_at:
        type: integer
      verify_status:
        description: unverified, pending, active, inactive, maintenance, suspended,
          banned, retired
        type: string
      vin:
        type: string
      year:
        type: integer
    type: object
  internal_handlers.ChangePasswordRequest:
    properties:
      new_password:
        description: 新密码
        type: string
      old_password:
        description: 旧密码
        type: string
    required:
    - new_password
    - old_password
    type: object
  internal_handlers.DeleteAccountRequest:
    properties:
      reason:
        description: 删除原因（可选）
        type: string
    type: object
  internal_handlers.LoginRequest:
    properties:
      app_id:
        description: 应用标识
        type: string
      device_id:
        description: 设备ID
        type: string
      email:
        description: login_type=email时必填
        type: string
      fcm_token:
        description: FCM推送相关字段（可选）
        type: string
      password:
        type: string
      phone:
        description: login_type=phone时必填
        type: string
      platform:
        description: 平台：ios, android, web
        type: string
      user_type:
        description: 必填：passenger, driver，用于区分同一手机号/邮箱的不同身份
        type: string
      verify_code:
        description: login_type=phone时必填
        type: string
    type: object
  internal_handlers.LoginResponse:
    properties:
      expires_at:
        type: integer
      is_verified:
        type: boolean
      needs_verify:
        description: '["email", "phone"]'
        items:
          type: string
        type: array
      refresh_at:
        type: integer
      token:
        type: string
      user:
        $ref: '#/definitions/greenride_internal_protocol.User'
    type: object
  internal_handlers.LogoutRequest:
    properties:
      fcm_token:
        description: FCM Token（可选，如果提供则只停用该设备的token）
        type: string
    type: object
  internal_handlers.RegisterRequest:
    properties:
      country_code:
        description: 可选，默认为卢旺达(RW)
        type: string
      email:
        type: string
      first_name:
        type: string
      invite_code:
        description: 可选邀请码
        type: string
      last_name:
        type: string
      password:
        type: string
      phone:
        type: string
      user_type:
        type: string
      username:
        type: string
      verify_code:
        description: 验证码 (可选，如果提供则优先验证手机，然后邮箱)
        type: string
    required:
    - username
    - verify_code
    type: object
  internal_handlers.RegisterResponse:
    properties:
      email:
        type: string
      phone:
        type: string
      user_id:
        type: string
      user_type:
        type: string
    type: object
  internal_handlers.ResetPasswordRequest:
    properties:
      code:
        description: 验证码
        type: string
      email:
        type: string
      method:
        description: email, phone
        enum:
        - email
        - phone
        type: string
      new_password:
        description: 新密码
        type: string
      phone:
        type: string
      user_type:
        description: 用户类型
        enum:
        - passenger
        - driver
        type: string
    required:
    - code
    - method
    - new_password
    - user_type
    type: object
  internal_handlers.SendVerifyCodeRequest:
    properties:
      country_code:
        description: 手机号国家代码，默认为卢旺达(RW)
        type: string
      email:
        description: 邮箱地址，有则发送邮箱验证码
        type: string
      phone:
        description: 手机号码，有则发送短信验证码
        type: string
      type:
        description: 验证码类型
        enum:
        - register
        - login
        - reset_password
        - change_phone
        - change_email
        type: string
      user_type:
        description: 用户类型，用于区分同一联系方式的不同身份
        enum:
        - passenger
        - driver
        type: string
    required:
    - type
    - user_type
    type: object
  internal_handlers.UpdateProfileRequest:
    properties:
      address:
        type: string
      avatar:
        type: string
      birthday:
        type: integer
      city:
        type: string
      country:
        type: string
      display_name:
        type: string
      first_name:
        type: string
      gender:
        type: string
      language:
        type: string
      last_name:
        type: string
      postal_code:
        type: string
      state:
        type: string
      timezone:
        type: string
      username:
        type: string
    type: object
  internal_handlers.UserVehicleRequest:
    type: object
  internal_handlers.VerifyCodeRequest:
    properties:
      code:
        description: 验证码
        type: string
      email:
        type: string
      method:
        description: email, phone
        type: string
      new_email:
        description: 更换邮箱时需要
        type: string
      new_password:
        description: 重置密码时需要
        type: string
      new_phone:
        description: 更换手机时需要
        type: string
      phone:
        type: string
      type:
        description: 验证码类型
        type: string
      user_id:
        description: 某些情况下需要用户ID
        type: string
      user_type:
        description: 用户类型，用于区分同一联系方式的不同身份
        enum:
        - passenger
        - driver
        type: string
    required:
    - code
    - method
    - type
    - user_type
    type: object
info:
  contact: {}
  description: |-
    GreenRide API Documentation
    ## Response Codes:
    - 0000: Success - 操作成功
    - 9999: System Error - 系统错误
    - 1000: Parameter Error - 参数错误
    - 1001: Authorization Error - 授权失败
    - 1002: Authentication Expired - 认证过期
    - 2001: User Error - 用户相关错误
    - 4001: Business Error - 业务错误
    - 4002: Data Expired - 数据过期
  title: GreenRide API
  version: "1.0"
paths:
  /account/delete:
    post:
      consumes:
      - application/json
      description: 软删除用户账户，添加删除标记和时间戳，保留数据但标记为已删除状态
      parameters:
      - description: 删除请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.DeleteAccountRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 删除失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 删除账户
      tags:
      - Api
      - 用户
  /change-password:
    post:
      consumes:
      - application/json
      description: 用户修改密码，需要提供旧密码
      parameters:
      - description: 修改密码请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.ChangePasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 修改失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 修改密码
      tags:
      - Api
      - 认证
  /checkout/status:
    post:
      consumes:
      - application/json
      description: 根据checkout_id查询订单和支付状态
      parameters:
      - description: checkout状态查询请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.CheckoutStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 查询失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      summary: 查询checkout状态
      tags:
      - Api
      - 支付
  /location/current:
    get:
      description: 获取当前用户的位置信息
      parameters:
      - description: Bearer token
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses: {}
      summary: 获取当前用户位置
      tags:
      - Api
      - 位置
  /location/update:
    post:
      consumes:
      - application/json
      description: 司机上报当前位置信息
      parameters:
      - description: Bearer token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 位置信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.UpdateLocationRequest'
      produces:
      - application/json
      responses: {}
      summary: 更新司机位置
      tags:
      - Api
      - 位置
  /login:
    post:
      consumes:
      - application/json
      description: 用户登录接口，支持邮箱和手机号登录
      parameters:
      - description: 登录请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 参数错误或认证失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      summary: 用户登录
      tags:
      - Api
      - 认证
  /logout:
    post:
      consumes:
      - application/json
      description: 用户登出，清除服务端相关信息。如果提供fcm_token，只停用该设备的FCM token；否则停用所有设备的token
      parameters:
      - description: 登出请求（可选参数）
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_handlers.LogoutRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 登出成功
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 用户登出
      tags:
      - Api
      - 认证
  /offline:
    post:
      consumes:
      - application/json
      description: 司机下线，只有司机类型用户可以调用此接口。下线后司机状态变为离线，车辆状态变为不可用
      produces:
      - application/json
      responses:
        "200":
          description: 下线成功
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 司机下线
      tags:
      - Api
      - 司机
  /online:
    post:
      consumes:
      - application/json
      description: 司机上线，只有司机类型用户可以调用此接口。上线后司机状态变为在线，车辆状态变为可用
      parameters:
      - description: 上线请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.UserOnlineRequest'
      produces:
      - application/json
      responses: {}
      security:
      - BearerAuth: []
      summary: 司机上线
      tags:
      - Api
      - 司机
  /order/accept:
    post:
      consumes:
      - application/json
      description: 服务提供者接受指定的订单
      parameters:
      - description: 接受订单请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderAcceptRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 接受失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 接受订单
      tags:
      - Api
      - 司机
  /order/arrived:
    post:
      consumes:
      - application/json
      description: 司机标记已到达接客地点，更新订单状态为司机已到达
      parameters:
      - description: 司机到达请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 到达失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 司机到达
      tags:
      - Api
      - 司机
  /order/cancel:
    post:
      consumes:
      - application/json
      description: 取消指定的订单
      parameters:
      - description: 取消请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderCancelAPIRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 取消失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 取消订单
      tags:
      - Api
      - 订单
  /order/cash/received:
    post:
      consumes:
      - application/json
      description: 司机确认已收到现金支付
      parameters:
      - description: 确认现金收款请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderPaymentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 确认失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 确认现金收款
      tags:
      - Api
      - 司机
  /order/create:
    post:
      consumes:
      - application/json
      description: 创建新的订单，支持网约车等类型
      parameters:
      - description: 创建订单请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.CreateOrderRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 创建失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 创建订单
      tags:
      - Api
      - 订单
  /order/detail:
    post:
      consumes:
      - application/json
      description: 获取指定订单的详细信息
      parameters:
      - description: 订单ID请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderIDRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 获取失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取订单详情
      tags:
      - Api
      - 订单
  /order/estimate:
    post:
      consumes:
      - application/json
      description: 根据起点终点和订单类型预估费用、距离和时间，支持价格快照和规则引擎。统一接口支持网约车、外卖、网购等多种订单类型
      parameters:
      - description: 预估请求，包含订单类型、用户信息、起终点等
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.EstimateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 预估失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 预估订单费用
      tags:
      - Api
      - 订单
  /order/finish:
    post:
      consumes:
      - application/json
      description: 司机完成订单执行，标记订单状态为已完成
      parameters:
      - description: 完成订单请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 完成失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 完成订单
      tags:
      - Api
      - 司机
  /order/nearby:
    post:
      consumes:
      - application/json
      description: 司机或服务提供者根据当前地理位置获取附近的待接订单列表，支持按距离、订单类型等条件进行筛选
      parameters:
      - description: 获取附近订单请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.GetNearbyOrdersRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功，返回附近订单列表
          schema:
            allOf:
            - $ref: '#/definitions/greenride_internal_protocol.Result'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/greenride_internal_protocol.Order'
                  type: array
              type: object
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
        "401":
          description: 用户未认证
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
        "403":
          description: 权限不足，仅司机或服务提供者可访问
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取附近的待接订单
      tags:
      - Api
      - 司机
  /order/payment:
    post:
      consumes:
      - application/json
      description: 处理用户订单支付，支持多种支付方式。沙盒模式下不实际请求支付渠道，直接返回成功。
      parameters:
      - description: 订单支付请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderPaymentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 支付处理失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 处理订单支付
      tags:
      - Api
      - 订单
      - 支付
  /order/rating:
    post:
      consumes:
      - application/json
      description: 对订单进行评价
      parameters:
      - description: 评价请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.CreateOrderRatingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 评价失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 创建评价
      tags:
      - Api
      - 订单
  /order/ratings:
    post:
      consumes:
      - application/json
      description: 获取订单的评价列表
      parameters:
      - description: 订单ID请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderIDRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 获取失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取评价列表
      tags:
      - Api
      - 订单
  /order/reject:
    post:
      consumes:
      - application/json
      description: 司机拒绝派单，支持枚举原因和自定义原因
      parameters:
      - description: 拒绝订单请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 拒绝失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 拒绝订单
      tags:
      - Api
      - 司机
  /order/start:
    post:
      consumes:
      - application/json
      description: 司机开始执行订单，标记订单状态为进行中
      parameters:
      - description: 开始订单请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.OrderActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 开始失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 开始订单
      tags:
      - Api
      - 司机
  /orders:
    post:
      consumes:
      - application/json
      description: 获取用户的订单列表，支持分页和类型过滤
      parameters:
      - description: 获取订单列表请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.UserRidesRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 获取失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取订单列表
      tags:
      - Api
      - 订单
  /payment/cancel:
    post:
      consumes:
      - application/json
      description: 用户主动取消订单支付
      parameters:
      - description: 取消支付请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.CancelPaymentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 取消失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 取消支付
      tags:
      - Api
      - 支付
  /payment/methods:
    post:
      consumes:
      - application/json
      description: 根据货币类型和金额查询支持的支付方式列表
      parameters:
      - description: 支付方式查询请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.PaymentMethodsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 获取失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取支付方式列表
      tags:
      - Api
      - 支付
  /profile:
    get:
      consumes:
      - application/json
      description: 获取当前登录用户的详细信息
      produces:
      - application/json
      responses:
        "200":
          description: 获取失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取用户信息
      tags:
      - Api
      - 用户
  /profile/update:
    post:
      consumes:
      - application/json
      description: 按需更新用户个人信息，只更新提供的字段
      parameters:
      - description: 更新请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.UpdateProfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 更新失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 更新个人信息
      tags:
      - Api
      - 用户
  /promotions:
    post:
      consumes:
      - application/json
      description: 获取优惠券列表，支持分页和过滤
      parameters:
      - description: 优惠券搜索条件
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.UserPromotionsRequest'
      produces:
      - application/json
      responses: {}
      security:
      - ApiKeyAuth: []
      summary: 获取优惠券列表
      tags:
      - Api
      - 优惠券
  /rating/delete:
    post:
      consumes:
      - application/json
      description: 删除订单评价
      parameters:
      - description: 评价ID请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.RatingIDRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 删除失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 删除评价
      tags:
      - Api
      - 订单
  /rating/reply:
    post:
      consumes:
      - application/json
      description: 服务提供者回复用户评价
      parameters:
      - description: 回复请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.ReplyToRatingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 回复失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 回复评价
      tags:
      - Api
      - 司机
  /rating/update:
    post:
      consumes:
      - application/json
      description: 更新订单评价
      parameters:
      - description: 评价更新请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.UpdateOrderRatingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 更新失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 更新评价
      tags:
      - Api
      - 订单
  /register:
    post:
      consumes:
      - application/json
      description: 用户注册接口，支持乘客和司机注册。country_code为可选参数，默认为卢旺达(RW)。如果提供verify_code，会自动按优先级验证：先验证手机验证码，如果失败再验证邮箱验证码
      parameters:
      - description: 注册请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.RegisterRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 参数错误或用户已存在
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      summary: 用户注册
      tags:
      - Api
      - 认证
  /reset-password:
    post:
      consumes:
      - application/json
      description: 通过验证码重置密码
      parameters:
      - description: 重置密码请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.ResetPasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 重置失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      summary: 重置密码
      tags:
      - Api
      - 认证
  /send-verify-code:
    post:
      consumes:
      - application/json
      description: 发送验证码到邮箱或手机。系统会自动根据提供的email和phone字段判断发送方式，优先使用phone。country_code为可选参数，默认为卢旺达(RW)
      parameters:
      - description: 发送验证码请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.SendVerifyCodeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 参数错误或发送失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      summary: 发送验证码
      tags:
      - Api
      - 认证
  /vehicle:
    post:
      consumes:
      - application/json
      description: 获取当前用户的车辆信息，司机返回绑定车辆，车主返回拥有的车辆
      parameters:
      - description: 查询请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.UserVehicleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 获取失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取用户车辆信息
      tags:
      - Api
      - 司机
  /vehicles:
    post:
      consumes:
      - application/json
      description: 获取车辆列表，支持分页和类型过滤
      parameters:
      - description: 获取车辆列表请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.GetVehiclesRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 获取失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      security:
      - BearerAuth: []
      summary: 获取车辆列表
      tags:
      - Api
      - 车辆
  /verify-code:
    post:
      consumes:
      - application/json
      description: 验证邮箱或手机验证码
      parameters:
      - description: 验证请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_handlers.VerifyCodeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 验证失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      summary: 验证验证码
      tags:
      - Api
      - 认证
  /webhook/{payment_id}:
    post:
      consumes:
      - application/json
      description: 接收 KPay 的支付状态回调通知，更新支付记录状态
      parameters:
      - description: 支付ID
        in: path
        name: payment_id
        required: true
        type: string
      - description: KPay Webhook 数据
        in: body
        name: webhook_data
        required: true
        schema:
          $ref: '#/definitions/greenride_internal_protocol.MapData'
      produces:
      - application/json
      responses:
        "200":
          description: 处理成功
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
        "400":
          description: 请求数据错误
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
        "404":
          description: 支付记录不存在
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
        "500":
          description: 处理失败
          schema:
            $ref: '#/definitions/greenride_internal_protocol.Result'
      summary: 处理 KPay 支付 Webhook 通知
      tags:
      - Api
      - 支付
      - Webhook
schemes:
- http
securityDefinitions:
  BearerAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
